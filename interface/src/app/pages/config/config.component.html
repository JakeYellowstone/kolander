<div class="config-page animate-fadeInUp">
    <div class="page-header">
        <h1>Configuration</h1>
        <p>Manage priority rules and system settings</p>
    </div>

    <div class="config-sections grid grid-2">
        <!-- Priority Rules -->
        <div class="config-section card">
            <h2>Group Priority Rules</h2>
            <p class="section-description">
                Define how user groups affect threat priority classification
            </p>

            <form [formGroup]="priorityForm" (ngSubmit)="savePriorityRules()">
                <div formArrayName="groupRules" class="rules-list">
                    <div *ngFor="let rule of groupRulesArray.controls; let i = index" [formGroupName]="i"
                        class="rule-item">
                        <div class="rule-header">
                            <h4>Rule {{ i + 1 }}</h4>
                            <button type="button" class="btn btn-danger" (click)="removeRule(i)"
                                *ngIf="groupRulesArray.length > 1">
                                Remove
                            </button>
                        </div>

                        <div class="form-group">
                            <label>Group Name</label>
                            <select formControlName="group" class="form-control">
                                <option value="executive">Executive Team</option>
                                <option value="management">Management</option>
                                <option value="developer">Development Team</option>
                                <option value="analyst">Security Analysts</option>
                                <option value="user">General Users</option>
                                <option value="contractor">Contractors</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Priority Multiplier</label>
                            <input type="number" formControlName="multiplier" class="form-control" min="0.1" max="3.0"
                                step="0.1">
                            <small>Higher values increase priority (1.0 = no change)</small>
                        </div>

                        <div class="form-group">
                            <label>Description</label>
                            <textarea formControlName="description" class="form-control" rows="2"></textarea>
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-success" (click)="addRule()">
                        Add Rule
                    </button>
                    <button type="submit" class="btn" [disabled]="!priorityForm.valid">
                        Save Priority Rules
                    </button>
                </div>
            </form>
        </div>

        <!-- Analysis Settings -->
        <div class="config-section card">
            <h2>Analysis Settings</h2>
            <p class="section-description">
                Configure AI model parameters and thresholds
            </p>

            <form [formGroup]="analysisForm" (ngSubmit)="saveAnalysisSettings()">
                <div class="form-group">
                    <label>Binary Classification Threshold</label>
                    <input type="range" formControlName="binaryThreshold" class="range-input" min="0.1" max="0.9"
                        step="0.1">
                    <div class="range-value">{{ analysisForm.get('binaryThreshold')?.value }}</div>
                    <small>Minimum confidence for threat detection</small>
                </div>

                <div class="form-group">
                    <label>High Priority Threshold</label>
                    <input type="range" formControlName="highPriorityThreshold" class="range-input" min="0.6" max="1.0"
                        step="0.05">
                    <div class="range-value">{{ analysisForm.get('highPriorityThreshold')?.value }}</div>
                    <small>Minimum score for high priority classification</small>
                </div>

                <div class="form-group">
                    <label>Medium Priority Threshold</label>
                    <input type="range" formControlName="mediumPriorityThreshold" class="range-input" min="0.3"
                        max="0.8" step="0.05">
                    <div class="range-value">{{ analysisForm.get('mediumPriorityThreshold')?.value }}</div>
                    <small>Minimum score for medium priority classification</small>
                </div>

                <div class="form-group">
                    <label>Enable Group Modulation</label>
                    <div class="toggle-switch">
                        <input type="checkbox" formControlName="enableGroupModulation" id="groupModulation">
                        <label for="groupModulation" class="toggle-label"></label>
                    </div>
                    <small>Apply group-based priority adjustments</small>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn" [disabled]="!analysisForm.valid">
                        Save Analysis Settings
                    </button>
                    <button type="button" class="btn btn-danger" (click)="resetToDefaults()">
                        Reset to Defaults
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Current Configuration Display -->
    <div class="current-config card">
        <h2>Current Configuration</h2>
        <div class="config-display grid grid-2">
            <div class="config-group">
                <h3>Priority Rules Summary</h3>
                <div class="rules-summary">
                    <div *ngFor="let rule of getCurrentPriorityRules()" class="rule-summary">
                        <span class="group-name">{{ rule.group }}</span>
                        <span class="multiplier">Ã—{{ rule.multiplier }}</span>
                    </div>
                </div>
            </div>

            <div class="config-group">
                <h3>Analysis Thresholds</h3>
                <div class="thresholds-summary">
                    <div class="threshold-item">
                        <span>Binary Classification:</span>
                        <span class="threshold-value">{{ analysisForm.get('binaryThreshold')?.value }}</span>
                    </div>
                    <div class="threshold-item">
                        <span>High Priority:</span>
                        <span class="threshold-value">{{ analysisForm.get('highPriorityThreshold')?.value }}</span>
                    </div>
                    <div class="threshold-item">
                        <span>Medium Priority:</span>
                        <span class="threshold-value">{{ analysisForm.get('mediumPriorityThreshold')?.value }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>