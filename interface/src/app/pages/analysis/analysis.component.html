<div class="analysis-page animate-fadeInUp">
    <div class="page-header">
        <h1>Analyse Menace</h1>
        <p>Chargez les donn√©es EDR pour une analyse de s√©curit√© bas√©e sur l'IA</p>
    </div>

    <!-- Error Message -->
    <div class="error-message card" *ngIf="errorMessage && !isProcessing">
        <div class="error-content">
            <div class="error-icon">‚ö†Ô∏è</div>
            <div>
                <h3>Erreur d'Analyse</h3>
                <p>{{ errorMessage }}</p>
                <button class="btn btn-danger" (click)="resetAnalysis()">R√©essayer</button>
            </div>
        </div>
    </div>

    <div class="analysis-workflow">
        <!-- Step 1: File Upload -->
        <div class="workflow-step" [class.completed]="uploadCompleted">
            <div class="step-header">
                <div class="step-number">1</div>
                <h2>Charger Donn√©es EDR</h2>
            </div>
            <app-file-upload (fileUploaded)="onFileUploaded($event)" (uploadProgress)="onUploadProgress($event)">
            </app-file-upload>
        </div>

        <!-- Step 2: Processing -->
        <div class="workflow-step" [class.active]="isProcessing" [class.completed]="analysisCompleted">
            <div class="step-header">
                <div class="step-number">2</div>
                <h2>Analyse IA</h2>
            </div>
            <div class="processing-panel card" *ngIf="isProcessing || analysisCompleted">
                <div class="processing-status">
                    <div class="loading" *ngIf="isProcessing"></div>
                    <div class="process-steps">
                        <div class="process-step" [class.completed]="processSteps.parsing">
                            <span class="step-icon">üìä</span>
                            <span>Pr√©paration Donn√©es</span>
                        </div>
                        <div class="process-step" [class.completed]="processSteps.binaryPrediction">
                            <span class="step-icon">ü§ñ</span>
                            <span>Classification Binaire</span>
                        </div>
                        <div class="process-step" [class.completed]="processSteps.priorityClassification">
                            <span class="step-icon">üéØ</span>
                            <span>Priorisation</span>
                        </div>
                        <div class="process-step" [class.completed]="processSteps.groupModulation">
                            <span class="step-icon">üë•</span>
                            <span>Modulation Priorit√© Groupe</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 3: Results -->
        <div class="workflow-step" [class.active]="analysisCompleted">
            <div class="step-header">
                <div class="step-number">3</div>
                <h2>R√©sultats Analyse</h2>
            </div>
            <app-results-table *ngIf="analysisCompleted" [results]="analysisResults" [totalProcessed]="totalProcessed"
                [threatsDetected]="threatsDetected">
            </app-results-table>
        </div>
    </div>
</div>